<div class="container">
  <h1>{{ title() }}</h1>

  @if (isLoading()) {
    <div class="loading-container">
      <mat-spinner></mat-spinner>
      <p>Loading toxicity classifier model...</p>
    </div>
  } @else {
    <div class="content-container">
      <mat-card class="quote-card">
        <mat-card-header>
          <mat-card-title>Kanye West Quote</mat-card-title>
        </mat-card-header>
        <mat-card-content>
          @if (!quote() && !isFetchingQuote()) {
            <div class="empty-quote">
              <p>Click the button below to load a random quote</p>
            </div>
          }

          @if (isFetchingQuote()) {
            <div class="loading-quote">
              <mat-spinner diameter="40"></mat-spinner>
              <p>Fetching quote...</p>
            </div>
          }

          @if (quote()) {
            <div class="quote-content">
              <blockquote>{{ quote() }}</blockquote>
            </div>
          }
        </mat-card-content>
        <mat-card-actions>
          <button mat-raised-button color="primary" (click)="fetchQuote()" [disabled]="isFetchingQuote()">
            {{ quote() ? 'Load Another Quote' : 'Load Quote' }}
          </button>
        </mat-card-actions>
      </mat-card>

      @if (quote()) {
        <mat-card class="classification-card">
          <mat-card-header>
            <mat-card-title>Toxicity Classification</mat-card-title>
          </mat-card-header>
          <mat-card-content>
            @if (!userGuess() && !isResultRevealed()) {
              <div class="guess-section">
                <p>Do you think this quote is toxic?</p>
                <div class="guess-buttons">
                  <button mat-raised-button color="warn" (click)="makeGuess(true)">Yes, it's toxic</button>
                  <button mat-raised-button color="accent" (click)="makeGuess(false)">No, it's not toxic</button>
                </div>
              </div>
            }

            @if (userGuess() !== null && !isResultRevealed()) {
              <div class="user-guess">
                <p>You guessed: <strong>{{ userGuess() ? 'Toxic' : 'Not Toxic' }}</strong></p>
              </div>
            }

            @if (isClassifying()) {
              <div class="classifying">
                <mat-spinner diameter="40"></mat-spinner>
                <p>Classifying quote...</p>
              </div>
            }

            @if (isResultRevealed() && toxicityResult() !== null) {
              <div class="result-section">
                <h3>Classification Result:</h3>
                <p class="result" [ngClass]="toxicityResult() ? 'toxic' : 'not-toxic'">
                  {{ toxicityResult() ? 'TOXIC' : 'NOT TOXIC' }}
                </p>

                @if (userGuess() !== null) {
                  <div class="user-comparison">
                    @if (userGuess() === toxicityResult()) {
                      <p class="correct">
                        Your guess was correct!
                      </p>
                    }
                    @if (userGuess() !== toxicityResult()) {
                      <p class="incorrect">
                        Your guess was incorrect.
                      </p>
                    }
                  </div>
                }
              </div>
            }
          </mat-card-content>
          <mat-card-actions>
            <button mat-raised-button color="primary" (click)="resetQuote()">Try Another Quote</button>
            @if (!isResultRevealed() && !userGuess()) {
              <button mat-button (click)="revealResult()">
                Skip Guessing
              </button>
            }
          </mat-card-actions>
        </mat-card>
      }
    </div>
  }
</div>
